#:schema node_modules/wrangler/config-schema.json
name = "vam-insurance-api"
main = "src/index.ts"
compatibility_date = "2025-11-17"
compatibility_flags = ["nodejs_compat"]

# Production Worker
workers_dev = true

# Account ID (set this after creating Cloudflare account)
# account_id = "your-account-id-here"

# R2 Bucket Bindings (for file storage)
[[r2_buckets]]
binding = "DOCUMENTS"
bucket_name = "vam-documents"
preview_bucket_name = "vam-documents-preview"

[[r2_buckets]]
binding = "IMAGES"
bucket_name = "vam-images"
preview_bucket_name = "vam-images-preview"

# D1 Database Binding (serverless SQLite)
[[d1_databases]]
binding = "DB"
database_name = "vam_insurance_db"
database_id = "your-d1-database-id" # Set after creating D1 database

# KV Namespace (for caching)
[[kv_namespaces]]
binding = "CACHE"
id = "your-kv-namespace-id" # Set after creating KV namespace
preview_id = "your-kv-preview-id"

# Environment Variables (non-sensitive)
[vars]
ENVIRONMENT = "production"
MAX_FILE_SIZE_MB = "10"
JWT_EXPIRE_MINUTES = "10080"

# Secrets (set via CLI: wrangler secret put SECRET_NAME)
# - GEMINI_API_KEY
# - OPENWEATHER_API_KEY
# - SECRET_KEY
# - FRONTEND_URL

# Triggers and Routes
# After adding custom domain, uncomment and update:
# routes = [
#   { pattern = "api.your-domain.workers.dev/*", zone_name = "your-domain.workers.dev" }
# ]

# Limits (Free Tier)
# - 100,000 requests/day
# - 10ms CPU time per request
# - 128MB memory per request
# - R2: 10GB storage, unlimited bandwidth
# - D1: 5GB storage, 5 million rows

[build]
command = "npm run build"

# Development settings
[dev]
port = 8787
local_protocol = "http"
